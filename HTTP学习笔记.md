# HTTP


## URL

##### URI主要有两个子集： `URL` 和 `URN`

* URL通过资源位置来标识资源
* URN通过名字来识别资源

**PURL** 永久统一资源定位符，用URL来实现URN功能。


##### URL语法由 9 部分组成

``````
<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag>
``````

* `path` 分为多个路径段(path segment)，每个路径段都有自己的 `params` .
* `frag` 字段不会传送给服务器，由客户端内部使用。




## 报文

HTTP使用术语流入 `inbound` 和流出 `outbound` 来描述事务处理 `transaction` .

报文**发送者**总是位于**接收者**的上游(upstream)，所有报文都会向下游(downstream)流动。


#### 报文的语法

请求报文：

``````xml
<method> <request-URL> <version>
<headers>

<entity-body>
``````

响应报文:

``````xml
<version> <status> <reason-phrase>
<headers>

<entity-body>
``````

起始行和首部总是以 `CRLF` 结束。



#### 方法

常用HTTP方法： GET HEAD POST PUT TRACE OPTIONS DELETE.
由于HTTP设计得易于扩展，服务器还可以定义自己的`扩展方法`。

GET和HEAD被认为是 `安全方法` 。

###### GET

HTTP1.1 服务器必须实现此方法。用于请求服务器发送某个资源。

###### HEAD

HTTP1.1 服务器必须实现此方法。
与 `GET` 类似，但服务器在响应中只返回首部。开发者要确保其首部与GET返回的相同。

###### PUT

向服务器写入文档。

###### POST

向服务器输入数据。通常用来支持HTML表单。

###### TRACE

发起“环回”诊断，查看所有中间HTTP应用程序组成的链。主要用于诊断。

###### OPTIONS

请求Web服务器告知其支持的各种功能。

###### DELETE

删除请求URL所指定的资源。


###### 扩展方法

没有在HTTP1.1正式规范定义的方法。

最好按照惯例“对所发送的内容要求严一点，对所接收的内容宽松一点”来处理扩展方法。



#### 状态码

###### 分类：

| 整个范围    | 已定义范围   | 分类         |
| ----------- |:------------:| ------------:|
| 100 ~ 199   | 100 ~ 101    | 信息提示     |
| 200 ~ 299   | 200 ~ 206    | 成功         |
| 300 ~ 399   | 300 ~ 305    | 重定向       |
| 400 ~ 499   | 400 ~ 415    | 客户端错误   |
| 500 ~ 599   | 500 ~ 505    | 服务器错误   |

**100 Continue**：是一种优化，客户端在避免向服务器发送大实体时使用。
通常与 `Expect` 请求头配合使用，客户端在发送实体前等待100响应。

**204 No Content**: 响应报文包含若干首部和一个状态行，无实体的主体部分。
主要用于浏览器不转为新文档的情况下，对其进行更新。


> 302、303、307的区别
> `302` 在HTTP1.0时使用：客户端发出POST请求后收到服务器的302状态码，那么不能自动的向新的URI发送重复请求，
> 必须跟用户确认是否该重发(POST方法非幂等)。但是多数浏览器会获取到HTTP响应报文首部的Location字段信息，
> 并发起一个GET请求。
> `303` 在HTTP1.1中使用：大多数支持HTTP1.1的浏览器会将 302 当作 303 处理，其意义与 302 完全相同。
> `307` 在HTTP1.1中使用：用来代替 302 , 不会把POST转为GET.
> 也就是说， 302 由HTTP1.0细化为HTTP1.1中的 303 和 307.

**410 Gone**：与404类似，只是服务器曾拥有过此资源。




#### 首部

分类：

* 通用首部：可以出现在请求、响应报文中
* 请求首部
* 响应首部
* 实体首部
* 扩展首部